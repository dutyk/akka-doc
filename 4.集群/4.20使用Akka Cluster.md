
您的架构选型是微服务体系结构还是传统的分布式应用程序。这个选择将影响您应如何使用Akka Cluster。

stateful or stateful applications: to Akka Cluster or not 是了解使用Akka集群动机的一个很好的起点。

# 微服务
微服务具有许多吸引人的特性，例如微服务的独立性允许多个更小，更专注的团队，这些团队可以更频繁地交付新功能并可以更快地响应商机。乔纳斯·博内尔(JonasBonér)在《反应微系统：规模化微服务的发展》一书中指出，反应性微服务应该是独立的，自治的，并负有单一责任。

在微服务架构中，您应该考虑服务内部以及服务之间的通信。

通常，我们建议不要在不同服务之间使用Akka Cluster和actor消息传递，因为这会导致服务之间的代码耦合太紧密，并且难以独立部署它们，这是使用微服务体系结构的主要原因之一。有关此背景知识，请参阅Lagom框架文档中的内部和外部通信讨论(每个微服务都是Akka集群)。

单个服务的节点(统称为集群)需要较少的去耦。它们共享相同的代码，并且由单个团队或个人作为一组部署在一起。在滚动部署过程中，可能同时运行两个版本，但是整个集合的部署只有一个控制点。因此，服务内通信可以利用Akka集群，故障管理和actor消息传递的优点，这些消息易于使用且性能出色。

在不同的服务之间，Akka HTTP或Akka gRPC可以用于同步(但尚未阻止)通信，而Akka Streams Kafka或其他Alpakka连接器可以用于集成异步通信。所有这些通信机制都可以很好地与具有端到端背压的消息流一起使用，并且同步通信工具也可以用于单个请求响应交互。同样重要的是要注意，使用这些工具时，不必使用Akka来实现通信的两端，编程语言也无关紧要。

# 传统的分布式应用
我们承认，微服务还带来了许多新的挑战，这不是构建应用程序的唯一方法。传统的分布式应用程序可能具有较低的复杂性，并且在许多情况下都可以很好地工作。例如，对于一个只有一个团队的小型初创公司而言，构建一个应用程序就是至关重要的。 Akka Cluster可以有效地用于构建此类分布式应用程序。

在这种情况下，您将具有一个部署单元，该部署单元是从单个代码库构建的(或使用传统的二进制依赖性管理进行模块化)，但使用单个集群跨多个节点进行部署。紧密耦合是可以的，因为这是部署和控制的中心点。在某些情况下，节点可能具有专门的运行时角色，这意味着集群不是完全同质的(例如，“前端”和“后端”节点，或专用的主节点/工作节点)，但是如果它们是从同一built artifacts运行，这只是运行时行为，不会出现完全分离的artifacts紧密耦合可能导致的同类问题。

紧密耦合的分布式应用程序已经为行业和许多Akka用户提供了良好的服务，并且仍然是一个有效的选择。

# 分布式整体
还有一种反模式，有时也称为“分布式整体”。您有相互独立构建和部署的多个服务，但是它们之间的紧密耦合使这非常危险，例如共享集群，共享代码和服务API调用的依赖项或共享数据库架构。由于代码和部署单元的物理分离，存在一种错误的自治意识，但是由于一种服务的实现更改泄漏到另一种服务的行为中，您可能会遇到问题。请参阅Ben Christensen的“不要建立分布式整体”。

遇到这种情况的组织通常会通过尝试集中协调多个服务的部署来做出反应，这时您在承担成本的同时失去了微服务的主要好处。您处于中间状态，无法以单独的方式构建和部署真正不可分离的事物。有些人这样做了，有些人设法使它起作用，但是我们不建议这样做，因此需要仔细管理。
